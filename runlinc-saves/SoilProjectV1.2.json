{"userHTML":"<div class=\"center-hor\">\n    <h1>Soil Health Monitor</h1>\n    <!--<div class=\"center-hor status-box\" style=\"background-color: greenyellow\">\n        <h1>STATUS: OK</h1>\n    </div>\n    <br>-->\n    <table class=\"center-hor\">\n        <tr>\n            <td>\n                <h2 class=\"center-hor\">Soil</h2>\n                <p id=\"moisture\"><b>Moisture:</b> Loading...</p>\n                <p id=\"nitrogen\"><b>Nitrogen:</b> Loading...</p>\n                <p id=\"phosphorus\"><b>Phosphorus:</b> Loading...</p>\n                <p id=\"potassium\"><b>Potassium:</b> Loading...</p>\n            </td>\n            <td>\n                <h2 class=\"center-hor\">Weather</h2>\n                <p id=\"temperature\"><b>Temperature:</b> Loading...</p>\n                <p id=\"humidity\"><b>Humidity:</b> Loading...</p>\n                <p id=\"raining\"><b>Raining:</b> Loading...</p>\n            </td>\n        </tr>\n    </table>\n    <br>\n    <h2 class=\"center-hor\">Ask Questions Using AI</h2>\n    <h5 class=\"center-hor\">Warning: Answers may not be completely accurate</h5>\n    <br>\n    <textarea readonly cols=\"32\" rows=\"8\" style=\"resize:none;\" id=\"answerBox\">","userCSS":"* {\n    font-family: Arial;\n}\n\n.center-hor {\n    margin: 0 auto;\n    text-align: center;\n}\n\n.status-box {\n    text-align: center;\n    vertical-align: middle;\n    width: 25%;\n\n    border: 3px solid;\n    padding: 10px;\n}\n\ntable, td {\n    text-align: left;\n    vertical-align: top;\n    \n    border: 3px solid;\n\n    width: 50%;\n    height: auto;\n}\n\ntd {\n    padding: 10px;\n    padding-bottom: 20px;\n}","userJS":"// Global variables storing the sensor data\nvar moisture = null;\nvar nitrogen = null;\nvar phosphorus = null;\nvar potassium = null;\nvar temperature = null;\nvar humidity = null;\nvar raining = null;\n\n// The function to ask an AI language model a question\nfunction askQuestion() {\n    // Get the elements we need\n    let answerBox = document.getElementById(\"answerBox\");\n    let question = document.getElementById(\"questionInput\");\n\n    // Make sure the question is not empty\n    if (question.value.length <= 0) {\n        alert(\"Please enter a question!\");\n        return;\n    }\n\n    // Greying out the elements so the user doesn't try send another question\n    answerBox.value = \"\";\n    answerBox.disabled = true;\n    question.disabled = true;\n    document.getElementById(\"questionInput\").disabled = true;\n\n    // Construct the JSON to send to the llm\n    let payload = new Object;\n    payload.moisture = `${moisture}%`;\n    payload.nitrogen = `${nitrogen} mg/kg`;\n    payload.phosphorus = `${phosphorus} mg/kg`;\n    payload.potassium = `${potassium} mg/kg`;\n    payload.temperature = `${temperature} degrees Celcius`;\n    payload.humidity = `${humidity}%`;\n    payload.raining = `${raining}`;\n\n    // Send request to server\n    fetch(\"http://192.168.20.10:5000/\", {\n        mode: \"cors\",\n        method: \"POST\",\n        headers: {\n            \"Accept\": \"application/json, text/plain, */*\",\n            \"Content-Type\": \"application/json\",\n            \"Access-Control-Allow-Origin\": \"*\",\n            \"Access-Control-Allow-Credentials\": \"true\",\n            \"Access-Control-Request-Methods\": \"GET,HEAD,OPTIONS,POST,PUT\",\n            \"Access-Control-Request-Headers\": \"Access-Control-Allow-Headers, Origin,Accept, X-Requested-With, Content-Type, Access-Control-Request-Method, Access-Control-Request-Headers\"\n        },\n        body: JSON.stringify( {\"question\": question.value, \"sensors\": payload} )\n    }).then(res => res.text()).then(function(res) {\n        // Add the response to the box\n        document.getElementById(\"answerBox\").value = res;\n        console.log(res);\n    }).catch(function(error) {\n        // Alerting of any failures\n        alert(\"Request falied: \" + error);\n    }).finally(() => {\n        // Re-enabling the elements\n        document.getElementById(\"answerBox\").disabled = false;\n        document.getElementById(\"questionInput\").disabled = false;\n        document.getElementById(\"questionButton\").disabled = false;\n    });\n}\n\n// Function to update the DOM with the sensor data\nfunction updateDom() {\n    document.getElementById(\"moisture\").innerHTML = `<b>Moisture:</b> ${moisture} %`;\n    document.getElementById(\"nitrogen\").innerHTML = `<b>Nitrogen:</b> ${nitrogen} mg/kg`;\n    document.getElementById(\"phosphorus\").innerHTML = `<b>Phosphorus:</b> ${phosphorus} mg/kg`;\n    document.getElementById(\"potassium\").innerHTML = `<b>Potassium:</b> ${potassium} mg/kg`;\n    document.getElementById(\"temperature\").innerHTML = `<b>Temperature:</b> ${temperature} *C`;\n    document.getElementById(\"humidity\").innerHTML = `<b>Humidity:</b> ${humidity} %`;\n    document.getElementById(\"raining\").innerHTML = `<b>Raining:</b> ${raining}`;\n}","userJSLoop":"// Read raw values from each sensor\nvar npkRaw = NPKIn( npkSensor ).split(\",\");\nvar tempHumidRaw = DHT11_In( tempHumidSensor ).split(\",\");\nmoisture = Math.round(analogIn( soilMoisture ) / 255 * 100);\nraining = parseInt(digitalIn( rainSensor )) == 1 ? \"Yes\" : \"No\";\n\n// Convert the values and set them in the js\nnitrogen = parseInt(npkRaw[0]);\nphosphorus = parseInt(npkRaw[1]);\npotassium = parseInt(npkRaw[2]);\ntemperature = parseInt(tempHumidRaw[0]);\nhumidity = parseInt(tempHumidRaw[1]);\n\n// Update the DOM with the new values\nupdateDom()\n\n// Delay 1s to make sure every sensor is read properly\nawait mSec( 800 );","boardName":"ESP32","userBoard":{"D2":{"options":["DISABLED","DIGITAL_OUT","PWM","SERVO","DIGITAL_IN"],"index":0,"name":"","value":0,"config":"DISABLED"},"D4":{"options":["DISABLED","DIGITAL_OUT","PWM","SERVO","DIGITAL_IN","DS18X20_IN"],"index":1,"name":"","value":0,"config":"DISABLED"},"D5":{"options":["DISABLED","DIGITAL_OUT","PWM","SERVO"],"index":2,"name":"","value":0,"config":"DISABLED"},"D12":{"options":["DISABLED","DIGITAL_OUT","PWM","SERVO"],"index":3,"name":"","value":0,"config":"DISABLED"},"D13":{"options":["DISABLED","DIGITAL_OUT","PWM","SERVO","DIGITAL_IN"],"index":4,"name":"","value":0,"config":"DISABLED"},"D14":{"options":["DISABLED","DIGITAL_OUT","PWM","SERVO"],"index":5,"name":"","value":0,"config":"DISABLED"},"D15":{"options":["DISABLED","DIGITAL_OUT","PWM","SERVO"],"index":6,"name":"","value":0,"config":"DISABLED"},"RX2":{"options":["DISABLED","DIGITAL_OUT","PWM","SERVO","DIGITAL_IN","GPS_IN","NPK_IN"],"index":7,"name":"npkSensor","value":0,"config":"NPK_IN"},"TX2":{"options":["DISABLED","DIGITAL_OUT","PWM","SERVO","DIGITAL_IN","GPS_OUT","NPK_OUT"],"index":8,"name":"","value":0,"config":"DISABLED"},"D18":{"options":["DISABLED","DIGITAL_OUT","PWM","SERVO","DIGITAL_IN"],"index":9,"name":"","value":0,"config":"DISABLED"},"D19":{"options":["DISABLED","DIGITAL_OUT","PWM","SERVO","DIGITAL_IN"],"index":10,"name":"","value":0,"config":"DISABLED"},"D21":{"options":["DISABLED","DIGITAL_OUT","PWM","SERVO","DIGITAL_IN","MAX30100_IN"],"index":11,"name":"","value":0,"config":"DISABLED"},"D22":{"options":["DISABLED","DIGITAL_OUT","PWM","SERVO","DIGITAL_IN"],"index":12,"name":"","value":0,"config":"DISABLED"},"D23":{"options":["DISABLED","DIGITAL_OUT","PWM","SERVO","DIGITAL_IN","DHT11_IN"],"index":13,"name":"tempHumidSensor","value":0,"config":"DHT11_IN"},"D25":{"options":["DISABLED","DIGITAL_OUT","PWM","SERVO","DIGITAL_IN"],"index":14,"name":"","value":0,"config":"DISABLED"},"D26":{"options":["DISABLED","DIGITAL_OUT","PWM","SERVO","DIGITAL_IN"],"index":15,"name":"","value":0,"config":"DISABLED"},"D27":{"options":["DISABLED","DIGITAL_OUT","PWM","SERVO","DIGITAL_IN"],"index":16,"name":"","value":0,"config":"DISABLED"},"D32":{"options":["DISABLED","DIGITAL_OUT","DIGITAL_IN","PWM","SERVO","ANALOG_IN"],"index":17,"name":"","value":0,"config":"DISABLED"},"D33":{"options":["DISABLED","DIGITAL_OUT","DIGITAL_IN","PWM","SERVO","ANALOG_IN"],"index":18,"name":"soilMoisture","value":0,"config":"ANALOG_IN"},"D34":{"options":["DISABLED","DIGITAL_IN","ANALOG_IN"],"index":19,"name":"rainSensor","value":0,"config":"DIGITAL_IN"},"D35":{"options":["DISABLED","DIGITAL_IN","ANALOG_IN"],"index":20,"name":"","value":0,"config":"DISABLED"},"VP":{"options":["DISABLED","DIGITAL_IN","ANALOG_IN"],"index":21,"name":"","value":0,"config":"DISABLED"},"RNG1":{"options":["DISABLED","ANALOG_IN"],"index":22,"name":"","value":0,"config":"DISABLED"},"RNG2":{"options":["DISABLED","ANALOG_IN"],"index":23,"name":"","value":0,"config":"DISABLED"},"VN":{"options":["DISABLED","DIGITAL_IN","ANALOG_IN"],"index":24,"name":"","value":0,"config":"DISABLED"}},"boardIP":"http://192.168.20.94"}